[クライアント1] <--WebSocket--> [ゲームサーバー] <--WebSocket--> [クライアント2]
```

### サーバーコンポーネント
- **ゲームサーバー (FastAPI + WebSocket)**
  - ゲーム状態の管理
  - プレイヤーセッションの処理
  - リアルタイム通信
  - ゲームロジックの実行

### クライアントコンポーネント
- **ゲームクライアント**
  - ユーザーインターフェース（現在のvisualizer.pyを拡張）
  - WebSocket通信
  - ローカル状態管理

## 通信プロトコル

### WebSocketイベント

1. **接続イベント**
   - `connect`: 初期接続
   - `disconnect`: クライアント切断
   - `join_game`: ゲーム参加リクエスト
   - `match_made`: マッチング成功

2. **ゲームイベント**
   - `game_start`: ゲーム初期化
   - `turn_start`: 新しいターンの通知
   - `draw_card`: カードを引く
   - `play_card`: カードを場に出す
   - `add_energy`: エネルギー追加
   - `attack`: 攻撃実行
   - `state_update`: ゲーム状態の同期
   - `game_end`: ゲーム終了

### ゲーム状態の同期
- サーバーが正当なゲーム状態を維持
- 状態更新は両クライアントにブロードキャスト
- スムーズな体験のためのクライアント側予測

## 実装計画

### フェーズ1: サーバーセットアップ
1. FastAPIを使用してWebSocketサーバーを作成
2. プレイヤーセッション管理の実装
3. ゲームルームのマッチメイキング設定

### フェーズ2: クライアント適応
1. 現在のゲームロジックをクライアント-サーバーモデルに修正
2. WebSocketクライアントの実装
3. ネットワークプレイ用にvisualizerを更新

### フェーズ3: ゲームロジックの分散
1. ゲーム状態管理をサーバーに移行
2. クライアント側予測の実装
3. 状態同期の追加

### フェーズ4: テストと改善
1. 接続エラー処理の追加
2. 再接続ロジックの実装
3. ゲーム状態の永続化

## セキュリティ考慮事項
- クライアントとサーバー両方での入力検証
- 不正防止のための状態検証
- セキュアなWebSocket接続
- アクションのレート制限

## 技術要件
- サーバー: Python FastAPI
- リアルタイム通信: WebSocket
- 状態キャッシュ: Redis（オプション）
- プレイヤー認証: JWT

## 注意点
- ネットワーク遅延の考慮
- 切断時の状態保持
- 不正な操作の防止
